#!/usr/bin/env sh

if [ "$#" -eq "0" ]
then
    printf "start: missing argument\n" >&2
    exit 1
fi

if case "$1" in 'http://'*) false;; 'https://'*) false;; *) [ ! -e "$1" ] ;; esac;
then
    printf "start: file \`%s' does not exist\n" "$1" >&2
    exit 1
fi

if [ -z "$WSL" ]
then
    xdg-open "$1" 1> /dev/null &
else
    if case "$1" in 'http://'*) true;; 'https://'*) true;; *) false;; esac;
    then
        path="$1"
    else
        path="$(realpath "$1" | sed -r 's/\//\\/g')"

        if case "$path" in '\mnt'*) true;; *) false;; esac;
        then
            path="$(printf '%s' "$path" | cut -c 5-)"
            if case "$path" in *\\*) true;; *) false;; esac
            then
                path="$(printf '%s' "$path" | sed -r 's/\\/:\\/')"
            else
                path="$path:"
            fi
        else
            path="\\\\wsl$\\Ubuntu$path"
        fi
    fi

    cmd.exe /C start "$path" 1> /dev/null
fi
