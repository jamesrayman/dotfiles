#!/usr/bin/env bash

set -euo pipefail


if [[ ! -v WSL ]]
then
    xdg-open "$@" 1> /dev/null
else 
    if [[ -z "$1" ]]
    then
        printf "start: missing argument\n" >&2
        exit 1
    fi

    if [[ "$1" == http://* || "$1" == https://* ]]
    then
        path="$1"
    else
        path="$(realpath "$1")"
        path="${path//\//\\}"

        if [[ "${path:0:5}" == '\mnt\' ]]
        then
            path="${path:5}"
            if [[ "$path" == *'\'* ]]
            then
                path="$(echo "$path" | sed -r 's/\\/:\\/')"
            else
                path="$path:"
            fi
        else
            path="\\\\wsl$\\Ubuntu$path"
        fi
    fi

    cmd.exe /C start "$path" 1> /dev/null
fi
